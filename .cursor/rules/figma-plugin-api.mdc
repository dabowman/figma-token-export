---
description: 
globs: 
alwaysApply: true
---
# Figma Plugin API

## Architecture
- Main Code (code.ts): Accesses Figma document
- UI Code (ui.html): Browser APIs, user interface
- Communication: 
  - Mainâ†’UI: `figma.ui.postMessage(msg)`
  - UIâ†’Main: `parent.postMessage({pluginMessage: msg}, '*')`

## Key Files
- manifest.json: Config (`name`, `id`, `api`, `main`)
- code.ts: Document interaction, must call `figma.closePlugin()`
- ui.html: User interface

## Best Practices
- Security: Limit network access, use HTTPS
- Performance: Batch operations, focus on specific tasks
- UI: Use Figma design system components
- Code: TypeScript, error handling, separation of concerns

## Common Pattern

// Main code
figma.showUI(__html__, { width: 300, height: 400 });
figma.ui.onmessage = msg => {
  if (msg.type === 'action') {
    // Handle action
    figma.ui.postMessage({ type: 'response' });
  }
};

// UI code
document.getElementById('button').onclick = () => {
  parent.postMessage({ pluginMessage: { type: 'action' }}, '*');
};
window.onmessage = ({data}) => {
  if (data.pluginMessage.type === 'response') {
    // Handle response
  }
};