<!DOCTYPE html>
<html>
<head>
  <style>
    /* Import Figma Plugin DS CSS */
    @import url('https://cdn.jsdelivr.net/gh/thomas-lowry/figma-plugin-ds/dist/figma-plugin-ds.css');

    body {
      background-color: var(--figma-color-bg);
      color: var(--figma-color-text);
      height: 100%;
    }
    .container {
      gap: var(--size-xxsmall);
      height: 100%;
    }
    .button-container {
      gap: var(--size-xxsmall);
      flex-grow: 1;
    }
    .button {
      cursor: pointer;
    }
    .status {
      font-size: var(--font-size-small);
      border-radius: var(--border-radius-large);
      background-color: var(--figma-color-bg-secondary);
      color: var(--figma-color-text-secondary);
      display: none;
      flex-grow: 2;
    }
  </style>
</head>
<body class="p-small">
  <div class="container flex column flex-no-wrap justify-content-start align-content-stretch">
    <div class="button-container flex column justify-content-start align-content-stretc flex-no-grow">
      <button class="button button--primary" id="export-tokens" title="Export standard format design tokens">Export Tokens</button>
      <button class="button button--secondary" id="export-raw" title="Export Raw Figma API data for debugging">Export Raw Data</button>
    </div>
    <div id="status" class="status p-xsmall"></div>
  </div>
  
  <script>
    const statusEl = document.getElementById('status');
    
    
    // Tokens only (main option)
    document.getElementById('export-tokens').onclick = () => {
      statusEl.textContent = 'Exporting tokens…';
      statusEl.style.display = 'block';
      parent.postMessage({ pluginMessage: { type: 'export-tokens-only' } }, '*');
    };
    
    // Raw data only
    document.getElementById('export-raw').onclick = () => {
      statusEl.textContent = 'Exporting raw data…';
      statusEl.style.display = 'block';
      parent.postMessage({ pluginMessage: { type: 'export-raw-only' } }, '*');
    };

    // Listen for messages from the plugin code
    onmessage = (event) => {
      const message = event.data.pluginMessage;
      if (message.type === 'download') {
        // Create and trigger download
        const blob = new Blob([JSON.stringify(message.content, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = message.filename;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
        
        // Update status message
        statusEl.textContent = `✅ ${message.filename} downloaded.`;
        
      }
    };
  </script>
</body>
</html> 